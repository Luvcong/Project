<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="categoryMapper">
	
	<resultMap id="categoryResultSet" type="category">
		<result column="RECIPE_CATEGORY_NO" property="recipeCategoryNo" />
		<result column="RECIPE_CATEGORY_NAME" property="recipeCategoryName" />
		<result column="RECIPE_CATEGORY_CNT" property="recipeCategoryCount" />
	</resultMap>
	
	<!-- 카테고리 리스트 조회 -->
	<select id="selectCategoryList" resultMap="categoryResultSet">
		SELECT
				RC.RECIPE_CATEGORY_NO,
				RC.RECIPE_CATEGORY_NAME,
				NVL(CTGR_CNT.CNT, 0) AS RECIPE_CATEGORY_CNT
		  FROM
		  		TB_RECIPE_CATEGORY RC
          LEFT OUTER JOIN
                         (SELECT
                                 RECIPE_CATEGORY_NO, COUNT(*) CNT
                            FROM 
                                 TB_RECIPE
                           GROUP
                              BY
                                 RECIPE_CATEGORY_NO) CTGR_CNT
                              ON
                           		 RC.RECIPE_CATEGORY_NO = CTGR_CNT.RECIPE_CATEGORY_NO
       					   ORDER
       					      BY
       					   		 RECIPE_CATEGORY_NO ASC
	</select>
	
	<!-- 카테고리 리스트 행 수 조회 -->
	<select id="selectCategoryListCount" resultType="_int">
		SELECT
	        	COUNT(*)
		  FROM
		        TB_RECIPE_CATEGORY
	</select>
	
	<!-- 카테고리 추가 -->
	<insert id="insertCategory" parameterType="category">
		INSERT
		  INTO
				TB_RECIPE_CATEGORY
		 VALUES
		 		(
		 		SEQ_RECIPE_CATEGORY.NEXTVAL,
		 		#{ recipeCategoryName }
		 		)
	</insert>
















</mapper>